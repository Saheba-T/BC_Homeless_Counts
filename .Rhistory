names_ls2 <- paste0("table3.",1:9)
# combine list names into a single list
table_names <- append(names_ls1,names_ls2)
# list of page numbers each table is on
page_numbers <- c(15,16,16,17,17,18,18,19,19,20,21,21,22,22,23,24,25,25,26,26,26,27,27,29,30,31,32,33,34,36,37)
# extract the tables from the pdf file
for (i in 1:length(table_names)){
assign(table_names[i],
extract_areas(pdf_file, page = page_numbers[i], output = "data.frame") %>% as.data.frame())
}
View(table2.10)
table2.10[7]
table2.10[7,]
table2.10[8,]
table2.10[-7,]
?rename_all
?rename
?rename_if
table2.10
str(table2.10)
?gsub
table2.10_c <- table2.10 %>%
rename( "Reason" = "Loss.of.Housing...more.than.1",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents"= "X.2",
"Percent_respondents"= "Total") %>%
transmute_at(.vars = vars(starts_with("Percent")),
.funs = funs(as.numeric(gsub("%", "", .))))
table2.10_c <- table2.10 %>%
rename( "Reason" = "Loss.of.Housing...more.than.1",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents"= "X.2",
"Percent_respondents"= "Total") %>%
transmute_at(.vars = vars(starts_with("Percent")),
.funs = list(as.numeric(gsub("%", "", .))))
table2.10_c <- table2.10 %>%
rename( "Reason" = "Loss.of.Housing...more.than.1",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents"= "X.2",
"Percent_respondents"= "Total") %>%
transmute_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .))))
View(table2.10_c)
mutate_at()
?mutate_at
table2.10_c <- table2.10 %>%
rename( "Reason" = "Loss.of.Housing...more.than.1",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents"= "X.2",
"Percent_respondents"= "Total") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .))))
table2.10_c <- table2.10 %>%
rename( "Reason" = "Loss.of.Housing...more.than.1",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents"= "X.2",
"Percent_respondents"= "Total") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %?%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(.)))
str(table2.10)
str(table2.10_c)
table2.10_c <- table2.10 %>%
rename( "Reason" = "Loss.of.Housing...more.than.1",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents"= "X.2",
"Percent_respondents"= "Total") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(.)))
table2.10_c <- table2.10 %>%
rename( "Reason" = "Loss.of.Housing...more.than.1",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents"= "X.2",
"Percent_respondents"= "Total") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total_")),
.funs = list(~ as.numeric(.)))
table2.10_c <- table2.10 %>%
rename( "Reason" = "Loss.of.Housing...more.than.1",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents"= "X.2",
"Percent_respondents"= "Total") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.))))
table2.10_c <- table2.10[-c(1,14,17),] %>%
rename( "Reason" = "Loss.of.Housing...more.than.1",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents"= "X.2",
"Percent_respondents"= "Total") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.))))
table2.10_c <- table2.10[-c(1,7,14,17),] %>%
rename( "Reason" = "Loss.of.Housing...more.than.1",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents"= "X.2",
"Percent_respondents"= "Total") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.))))
table2.10_c[8,1]
table2.10_c[6,1]
table2.10_c[6,1] <- "Complaint (e.g. pets/noise/damage)"
table2.10_c[12,1] <- "Experienced abuse by parent/guardian"
table2.10_c[14,1] <- "Death or Departure of family member"
table2.10_c[12, c("Total_respondents", "Percent_respondents")] <- c(84,2)
table2.10_c <- table2.10[-c(1,7,14,17),] %>%
rename( "Applicable_reason(s)" = "Loss.of.Housing...more.than.1",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents"= "X.2",
"Percent_respondents"= "Total") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.))))
# Modify values of some columns
table2.10_c[6,1] <- "Complaint (e.g. pets/noise/damage)"
table2.10_c[12,1] <- "Experienced abuse by parent/guardian"
table2.10_c[14,1] <- "Death or Departure of family member"
table2.10_c[12, c("Total_respondents", "Percent_respondents")] <- c(84,2)
library(readr)
View(table2.11)
colnames(table2.11)
# clean table 2.11 - Health Conditions
table2.11_c <- table2.11 %>%
rename("Health_condition(s)" = "",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents" = "X.2",
"Percent_respondents" = "Total",
"year_2018" = "X2018")
# clean table 2.11 - Health Conditions
table2.11_c <- table2.11 %>%
rename("Health_condition(s)" = "Health.Conditions..more",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents" = "X.2",
"Percent_respondents" = "Total",
"year_2018" = "X2018")
View(table2.11_c)
# clean table 2.11 - Health Conditions
table2.11_c <- table2.11[-c(1,6),] %>%
rename("Health_condition(s)" = "Health.Conditions..more",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents" = "X.2",
"Percent_respondents" = "Total",
"year_2018" = "X2018")
# clean table 2.11 - Health Conditions
table2.11_c <- table2.11[-c(1,6),] %>%
rename("Health_condition(s)" = "Health.Conditions..more",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents" = "X.2",
"Percent_respondents" = "Total",
"year_2018" = "X2018") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.))))
table2.11_c[5,1] <- "Learning disability or cognitive impairment"
# clean table 2.11 - Health Conditions
table2.11_c <- table2.11[-c(1,6),] %>%
rename("Health_condition(s)" = "Health.Conditions..more",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents" = "X.2",
"Percent_respondents" = "Total",
"year_2018" = "X2018") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.)))) %>%
mutate( "year_2018" = as.numeric(gsub("%","",.)))
# clean table 2.11 - Health Conditions
table2.11_c <- table2.11[-c(1,6),] %>%
rename("Health_condition(s)" = "Health.Conditions..more",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents" = "X.2",
"Percent_respondents" = "Total",
"year_2018" = "X2018") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.)))) %>%
mutate( "year_2018" = as.numeric(gsub("%","","year_2018")))
# clean table 2.11 - Health Conditions
table2.11_c <- table2.11[-c(1,6),] %>%
rename("Health_condition(s)" = "Health.Conditions..more",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents" = "X.2",
"Percent_respondents" = "Total",
"year_2018" = "X2018") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.)))) %>%
mutate("year_2018" = as.numeric(str_subset("year_2018", "\\d")))
# clean table 2.11 - Health Conditions
table2.11_c <- table2.11[-c(1,6),] %>%
rename("Health_condition(s)" = "Health.Conditions..more",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents" = "X.2",
"Percent_respondents" = "Total",
"year_2018" = "X2018") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.)))) %>%
mutate("year_2018" = as.numeric(grep("\\d", "year_2018", value = TRUE)))
# clean table 2.11 - Health Conditions
table2.11_c <- table2.11[-c(1,6),] %>%
rename("Health_condition(s)" = "Health.Conditions..more",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents" = "X.2",
"Percent_respondents" = "Total",
"year_2018" = "X2018") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.)))) %>%
mutate("year_2018" = as.numeric(grep("\\d", year_2018, value = TRUE)))
# clean table 2.11 - Health Conditions
table2.11_c <- table2.11[-c(1,6),] %>%
rename("Health_condition(s)" = "Health.Conditions..more",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents" = "X.2",
"Percent_respondents" = "Total",
"year_2018" = "X2018") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.)))) %>%
mutate("year_2018" = as.numeric(grep("\\d", year_2018, value = TRUE)))
# clean table 2.11 - Health Conditions
table2.11_c <- table2.11[-c(1,6),] %>%
rename("Health_condition(s)" = "Health.Conditions..more",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents" = "X.2",
"Percent_respondents" = "Total",
"year_2018" = "X2018") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.)))) %>%
as.numeric(str_subset(table2.11[,8], "//d"))
# clean table 2.11 - Health Conditions
table2.11_c <- table2.11[-c(1,6),] %>%
rename("Health_condition(s)" = "Health.Conditions..more",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents" = "X.2",
"Percent_respondents" = "Total",
"year_2018" = "X2018") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.))))
table2.11_c[5,1] <- "Learning disability or cognitive impairment"
table2.11_c[,"year_2018"] <- str_subset(table2.11_c[,"year_2018"], "\\d")
# clean table 2.11 - Health Conditions
table2.11_c <- table2.11[-c(1,6),] %>%
rename("Health_condition(s)" = "Health.Conditions..more",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents" = "X.2",
"Percent_respondents" = "Total",
"year_2018" = "X2018") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.))))
table2.11_c[5,1] <- "Learning disability or cognitive impairment"
table2.11_c[,"year_2018"] <- as.numeric(str_subset(table2.11_c[,"year_2018"], "\\d"))
# clean table 2.11 - Health Conditions
table2.11_c <- table2.11[-c(1,6),] %>%
rename("Health_condition(s)" = "Health.Conditions..more",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents" = "X.2",
"Percent_respondents" = "Total",
"year_2018" = "X2018") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.)))) %>%
mutate_at(.vars = vars("year_2018"),
.funs = list(~ as.numeric(gsub("%","",.))))
# clean table 2.11 - Health Conditions
table2.11_c <- table2.11[-c(1,6),] %>%
rename("Health_condition(s)" = "Health.Conditions..more",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents" = "X.2",
"Percent_respondents" = "Total",
"year_2018" = "X2018") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.))))
table2.11_c[5,1] <- "Learning disability or cognitive impairment"
table2.11_c[,"year_2018"] <- as.numeric(gsub("%","",table2.11_c[,"year_2018"]))
View(table2.4)
colnames(table2.4)
# clean table2.4 - Age
table2.4_c <- table2.4[-c(1,2),] %>%
rename("Age_groups" = "X",
"Total_sheltered" = "X.1",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.2",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents" = "X.3",
"Percent_respondents" = "Total",
"year_2018" = "X2018") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.))))
View(table2.4_c)
table2.4_c[,"year_2018"] <- as.numeric(gsub("%","",table2.4_c[,"year_2018"]))
View(table2.2)
colnames(table2.2)
# clean table2.2 - Gender
table2.2_c <- table[-c(1,2),-2] %>%
rename( "Gender_identity" = "X",
"Total_sheltered" = "X.2",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.3",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents" = "X.4",
"Percent_respondents" = "Total",
"year_2018" = "X2018") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.))))
table2.2_c[,"year_2018"] <- as.numeric(gsub("%","",table2.2_c[,"year_2018"]))
table2.2_c[,"year_2018"] <- as.numeric(gsub("%","",table2.2_c[,"year_2018"]))
View(table2.2)
# clean table2.2 - Gender
table2.2_c <- table2.2[-c(1,2),-2] %>%
rename( "Gender_identity" = "X",
"Total_sheltered" = "X.2",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.3",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents" = "X.4",
"Percent_respondents" = "Total",
"year_2018" = "X2018") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.))))
table2.2_c[,"year_2018"] <- as.numeric(gsub("%","",table2.2_c[,"year_2018"]))
View(table2.2_c)
View(table2.6)
colnames(table2.6)
# clean table2.6 - Racial identity
table2.6_c <- table2.6[-c(1,8,11),] %>%
rename( "Applicable_reason(s)" = "Racial.Identity..more.than",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents"= "X.2",
"Percent_respondents"= "Total") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.))))
View(table2.6_c)
table2.6_c[7,1] <- "Black - Caribbean and Latin America"
table2.6[9,1] <- "Black - Canadian/American"
table2.6_[9,1] <- "Latin America"
table2.6[9,1] <- "Latin America"
# clean table2.6 - Racial identity
table2.6_c <- table2.6[-c(1,8,11),] %>%
rename( "Applicable_reason(s)" = "Racial.Identity..more.than",
"Total_sheltered" = "X",
"Percent_sheltered" = "Sheltered",
"Total_unsheltered" = "X.1",
"Percent_unsheltered" = "Unsheltered",
"Total_respondents"= "X.2",
"Percent_respondents"= "Total") %>%
mutate_at(.vars = vars(starts_with("Percent")),
.funs = list(~ as.numeric(gsub("%", "", .)))) %>%
mutate_at(.vars = vars(starts_with("Total")),
.funs = list(~ as.numeric(gsub(",","",.))))
table2.6_c[7,1] <- "Black - Caribbean and Latin America"
table2.6_c[9,1] <- "Latin America"
table2.6_c[9,1] <- "Black - Canadian/American"
table_names[1]
get("table2.1")
get(table_names[1])
?write_csv
# Save data frames of raw data as csv in raw data folder
for (i in table_names){
df <- get(i)
if (is.data.frame(df)){
filename <- paste0(i,"csv")
write_csv(df, filename)
}
}
names_ls1 <- paste0("table2.",1:23)
# names of data tables gathered across communities
names_ls2 <- paste0("table3.",1:9)
# combine the two lists of names into a single list
table_names <- append(names_ls1,names_ls2)
# list of page numbers each table is on
page_numbers <- c(15,16,16,17,17,18,18,19,19,20,21,21,22,22,23,24,25,25,26,
26,26,27,27,29,30,31,32,33,34,35,36,37)
# extract the tables from the pdf file
for (i in 1:length(table_names)){
assign(table_names[i],
extract_areas(pdf_file, page = page_numbers[i], output = "data.frame")
%>% as.data.frame())
}
#---------
# Save data frames of raw data as csv in raw data folder
for (i in table_names){
df <- get(i)
if (is.data.frame(df)){
filename <- paste0(i,"csv")
write_csv(df, filename)
}
}
#---------
# Save data frames of raw data as csv in raw data folder
for (i in table_names){
df <- get(i)
if (is.data.frame(df)){
filename <- paste0("data//raw_data//",i,".csv")
write_csv(df, filename)
}
}
